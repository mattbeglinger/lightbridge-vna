# ==============================================================================
# LIGHTBRIDGE PRIMARY (AWS US-EAST-1)
# ==============================================================================

global:
  storageClass: "gp2" # Standard AWS Storage Class

# ------------------------------------------------------------------------------
# 1. MINIO (Object Storage)
# ------------------------------------------------------------------------------
minio:
  mode: distributed
  replicas: 4
  persistence:
    size: 10Gi
  rootUser: "admin"
  rootPassword: "SuperSecretPassword123!"
  buckets:
    - name: orthanc-data
      policy: public
      versioning: true

# ------------------------------------------------------------------------------
# 2. POSTGRES (Database)
# Managed by CloudNativePG Operator, so we disable the chart's default DB.
# ------------------------------------------------------------------------------
postgresql:
  enabled: false

# ------------------------------------------------------------------------------
# 3. KEYCLOAK (Identity)
# ------------------------------------------------------------------------------
keycloak:
  auth:
    adminUser: "admin"
    adminPassword: "SuperSecretPassword123!"
  
  # Connect to the internal Postgres (managed by CNPG)
  externalDatabase:
    host: "lightbridge-db-rw"
    user: "app"
    password: "app-password"
    database: "keycloak"

  # CRITICAL FIX: PROXY CONFIGURATION
  # This tells Keycloak it is behind an Ingress (ALB) and should trust headers.
  extraEnvVars:
    - name: KC_PROXY
      value: "edge"
    - name: KC_HOSTNAME_STRICT
      value: "false" # Allows dynamic ALB hostnames without crashing
    - name: KC_HTTP_ENABLED
      value: "true" # Keycloak listens on HTTP; ALB handles HTTPS termination

# ------------------------------------------------------------------------------
# 4. LIGHTBRIDGE APP CONFIG (Custom Values)
# ------------------------------------------------------------------------------
orthanc:
  name: "lightbridge-orthanc"
  image: "jodogne/orthanc-plugins:1.12.1"
  
camel:
  image: "apache/camel-k:2.2.0"
